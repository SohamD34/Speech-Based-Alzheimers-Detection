2025-04-16 07:38:37,658 - INFO - ================================================================================
2025-04-16 07:38:37,658 - INFO - NEW TRAINING RUN: spec_cnn on all dataset with language awareness: True
2025-04-16 07:38:37,658 - INFO - Parameters: Epochs=30, Batch Size=8, LR=0.003, Weight Decay=1e-05
2025-04-16 07:38:37,658 - INFO - Continue Training: False, Patience: 10
2025-04-16 07:38:37,658 - INFO - ================================================================================
2025-04-16 07:38:37,669 - INFO - Using device: cuda

2025-04-16 07:38:37,669 - INFO - Loading dataset...
2025-04-16 07:38:37,682 - INFO - Dataset loaded - Train set: 413, Validation set: 51, Test set: 53

2025-04-16 07:38:37,683 - INFO - Using CombinedCrossEntropyLoss for language-aware training
2025-04-16 07:38:37,683 - INFO - Initializing model and optimizer...
2025-04-16 07:38:38,025 - INFO - No checkpoint found. Starting training from scratch.
2025-04-16 07:38:38,025 - INFO - Model and optimizer initialized.

2025-04-16 07:38:38,025 - INFO - TrainHandler initialized for model: spec_cnn with language awareness: True

2025-04-16 07:38:38,025 - INFO - Starting model training process
2025-04-16 07:38:38,025 - INFO - Starting training process for 30 epochs with patience 10

2025-04-16 07:38:38,025 - INFO - === Starting Epoch 1/30 ===
2025-04-16 07:38:38,025 - INFO - Starting training for epoch 1
2025-04-16 07:38:40,476 - INFO - Epoch 1 completed - Train Loss: 0.8560, Train Acc: 51.82%
2025-04-16 07:38:40,477 - INFO - Starting validation for epoch 1
2025-04-16 07:38:40,958 - INFO - Epoch 1 validation - Val Loss: 1.2322, Val Acc: 37.25%

2025-04-16 07:38:40,959 - INFO - Saving model and training statistics to ../models/spec_cnn/all_lang_aware
2025-04-16 07:38:40,977 - INFO - Model checkpoint saved at epoch 1 with validation loss: 1.2322

2025-04-16 07:38:40,977 - INFO - New best model saved at epoch 1 with validation loss: 1.2322
2025-04-16 07:38:40,977 - INFO - === Completed Epoch 1/30 ===

2025-04-16 07:38:40,977 - INFO - === Starting Epoch 2/30 ===
2025-04-16 07:38:40,977 - INFO - Starting training for epoch 2
2025-04-16 07:38:42,846 - INFO - Epoch 2 completed - Train Loss: 0.7681, Train Acc: 56.42%
2025-04-16 07:38:42,846 - INFO - Starting validation for epoch 2
2025-04-16 07:38:43,307 - INFO - Epoch 2 validation - Val Loss: 0.6391, Val Acc: 62.75%

2025-04-16 07:38:43,307 - INFO - Saving model and training statistics to ../models/spec_cnn/all_lang_aware
2025-04-16 07:38:43,326 - INFO - Model checkpoint saved at epoch 2 with validation loss: 0.6391

2025-04-16 07:38:43,326 - INFO - New best model saved at epoch 2 with validation loss: 0.6391
2025-04-16 07:38:43,326 - INFO - === Completed Epoch 2/30 ===

2025-04-16 07:38:43,326 - INFO - === Starting Epoch 3/30 ===
2025-04-16 07:38:43,326 - INFO - Starting training for epoch 3
2025-04-16 07:38:45,157 - INFO - Epoch 3 completed - Train Loss: 0.7338, Train Acc: 56.42%
2025-04-16 07:38:45,158 - INFO - Starting validation for epoch 3
2025-04-16 07:38:45,598 - INFO - Epoch 3 validation - Val Loss: 0.6265, Val Acc: 62.75%

2025-04-16 07:38:45,599 - INFO - Saving model and training statistics to ../models/spec_cnn/all_lang_aware
2025-04-16 07:38:45,617 - INFO - Model checkpoint saved at epoch 3 with validation loss: 0.6265

2025-04-16 07:38:45,617 - INFO - New best model saved at epoch 3 with validation loss: 0.6265
2025-04-16 07:38:45,617 - INFO - === Completed Epoch 3/30 ===

2025-04-16 07:38:45,617 - INFO - === Starting Epoch 4/30 ===
2025-04-16 07:38:45,618 - INFO - Starting training for epoch 4
2025-04-16 07:38:47,456 - INFO - Epoch 4 completed - Train Loss: 0.7369, Train Acc: 56.90%
2025-04-16 07:38:47,456 - INFO - Starting validation for epoch 4
2025-04-16 07:38:47,911 - INFO - Epoch 4 validation - Val Loss: 0.7174, Val Acc: 64.71%

2025-04-16 07:38:47,911 - INFO - No improvement for 1 epochs. Best val loss: 0.6265 at epoch 3
2025-04-16 07:38:47,911 - INFO - === Completed Epoch 4/30 ===

2025-04-16 07:38:47,911 - INFO - === Starting Epoch 5/30 ===
2025-04-16 07:38:47,911 - INFO - Starting training for epoch 5
2025-04-16 07:38:49,689 - INFO - Epoch 5 completed - Train Loss: 0.7594, Train Acc: 57.63%
2025-04-16 07:38:49,689 - INFO - Starting validation for epoch 5
2025-04-16 07:38:50,106 - INFO - Epoch 5 validation - Val Loss: 0.6924, Val Acc: 54.90%

2025-04-16 07:38:50,107 - INFO - No improvement for 2 epochs. Best val loss: 0.6265 at epoch 3
2025-04-16 07:38:50,107 - INFO - === Completed Epoch 5/30 ===

2025-04-16 07:38:50,107 - INFO - === Starting Epoch 6/30 ===
2025-04-16 07:38:50,107 - INFO - Starting training for epoch 6
2025-04-16 07:38:51,926 - INFO - Epoch 6 completed - Train Loss: 0.7182, Train Acc: 64.16%
2025-04-16 07:38:51,926 - INFO - Starting validation for epoch 6
2025-04-16 07:38:52,375 - INFO - Epoch 6 validation - Val Loss: 0.6662, Val Acc: 62.75%

2025-04-16 07:38:52,375 - INFO - Learning rate adjusted from 0.003 to 0.0015
2025-04-16 07:38:52,375 - INFO - No improvement for 3 epochs. Best val loss: 0.6265 at epoch 3
2025-04-16 07:38:52,375 - INFO - === Completed Epoch 6/30 ===

2025-04-16 07:38:52,375 - INFO - === Starting Epoch 7/30 ===
2025-04-16 07:38:52,375 - INFO - Starting training for epoch 7
2025-04-16 07:38:54,177 - INFO - Epoch 7 completed - Train Loss: 0.6902, Train Acc: 63.68%
2025-04-16 07:38:54,177 - INFO - Starting validation for epoch 7
2025-04-16 07:38:54,623 - INFO - Epoch 7 validation - Val Loss: 0.5611, Val Acc: 70.59%

2025-04-16 07:38:54,623 - INFO - Saving model and training statistics to ../models/spec_cnn/all_lang_aware
2025-04-16 07:38:54,641 - INFO - Model checkpoint saved at epoch 7 with validation loss: 0.5611

2025-04-16 07:38:54,641 - INFO - New best model saved at epoch 7 with validation loss: 0.5611
2025-04-16 07:38:54,641 - INFO - === Completed Epoch 7/30 ===

2025-04-16 07:38:54,641 - INFO - === Starting Epoch 8/30 ===
2025-04-16 07:38:54,642 - INFO - Starting training for epoch 8
2025-04-16 07:38:56,443 - INFO - Epoch 8 completed - Train Loss: 0.6531, Train Acc: 69.01%
2025-04-16 07:38:56,443 - INFO - Starting validation for epoch 8
2025-04-16 07:38:56,887 - INFO - Epoch 8 validation - Val Loss: 0.5897, Val Acc: 74.51%

2025-04-16 07:38:56,887 - INFO - No improvement for 1 epochs. Best val loss: 0.5611 at epoch 7
2025-04-16 07:38:56,887 - INFO - === Completed Epoch 8/30 ===

2025-04-16 07:38:56,887 - INFO - === Starting Epoch 9/30 ===
2025-04-16 07:38:56,887 - INFO - Starting training for epoch 9
2025-04-16 07:38:58,652 - INFO - Epoch 9 completed - Train Loss: 0.6430, Train Acc: 65.86%
2025-04-16 07:38:58,652 - INFO - Starting validation for epoch 9
2025-04-16 07:38:59,122 - INFO - Epoch 9 validation - Val Loss: 0.6312, Val Acc: 60.78%

2025-04-16 07:38:59,122 - INFO - No improvement for 2 epochs. Best val loss: 0.5611 at epoch 7
2025-04-16 07:38:59,122 - INFO - === Completed Epoch 9/30 ===

2025-04-16 07:38:59,122 - INFO - === Starting Epoch 10/30 ===
2025-04-16 07:38:59,122 - INFO - Starting training for epoch 10
2025-04-16 07:39:00,937 - INFO - Epoch 10 completed - Train Loss: 0.6382, Train Acc: 67.31%
2025-04-16 07:39:00,937 - INFO - Starting validation for epoch 10
2025-04-16 07:39:01,413 - INFO - Epoch 10 validation - Val Loss: 0.6775, Val Acc: 72.55%

2025-04-16 07:39:01,413 - INFO - Learning rate adjusted from 0.0015 to 0.00075
2025-04-16 07:39:01,413 - INFO - No improvement for 3 epochs. Best val loss: 0.5611 at epoch 7
2025-04-16 07:39:01,413 - INFO - === Completed Epoch 10/30 ===

2025-04-16 07:39:01,413 - INFO - === Starting Epoch 11/30 ===
2025-04-16 07:39:01,413 - INFO - Starting training for epoch 11
2025-04-16 07:39:03,205 - INFO - Epoch 11 completed - Train Loss: 0.6155, Train Acc: 69.01%
2025-04-16 07:39:03,206 - INFO - Starting validation for epoch 11
2025-04-16 07:39:03,653 - INFO - Epoch 11 validation - Val Loss: 0.6457, Val Acc: 64.71%

2025-04-16 07:39:03,653 - INFO - No improvement for 4 epochs. Best val loss: 0.5611 at epoch 7
2025-04-16 07:39:03,653 - INFO - === Completed Epoch 11/30 ===

2025-04-16 07:39:03,653 - INFO - === Starting Epoch 12/30 ===
2025-04-16 07:39:03,653 - INFO - Starting training for epoch 12
2025-04-16 07:39:05,464 - INFO - Epoch 12 completed - Train Loss: 0.6186, Train Acc: 69.25%
2025-04-16 07:39:05,464 - INFO - Starting validation for epoch 12
2025-04-16 07:39:05,920 - INFO - Epoch 12 validation - Val Loss: 0.5345, Val Acc: 70.59%

2025-04-16 07:39:05,920 - INFO - Saving model and training statistics to ../models/spec_cnn/all_lang_aware
2025-04-16 07:39:05,938 - INFO - Model checkpoint saved at epoch 12 with validation loss: 0.5345

2025-04-16 07:39:05,938 - INFO - New best model saved at epoch 12 with validation loss: 0.5345
2025-04-16 07:39:05,938 - INFO - === Completed Epoch 12/30 ===

2025-04-16 07:39:05,938 - INFO - === Starting Epoch 13/30 ===
2025-04-16 07:39:05,938 - INFO - Starting training for epoch 13
2025-04-16 07:39:07,751 - INFO - Epoch 13 completed - Train Loss: 0.6323, Train Acc: 66.34%
2025-04-16 07:39:07,751 - INFO - Starting validation for epoch 13
2025-04-16 07:39:08,204 - INFO - Epoch 13 validation - Val Loss: 0.5847, Val Acc: 72.55%

2025-04-16 07:39:08,204 - INFO - No improvement for 1 epochs. Best val loss: 0.5345 at epoch 12
2025-04-16 07:39:08,204 - INFO - === Completed Epoch 13/30 ===

2025-04-16 07:39:08,204 - INFO - === Starting Epoch 14/30 ===
2025-04-16 07:39:08,204 - INFO - Starting training for epoch 14
2025-04-16 07:39:10,014 - INFO - Epoch 14 completed - Train Loss: 0.6166, Train Acc: 67.31%
2025-04-16 07:39:10,014 - INFO - Starting validation for epoch 14
2025-04-16 07:39:10,449 - INFO - Epoch 14 validation - Val Loss: 0.5412, Val Acc: 72.55%

2025-04-16 07:39:10,449 - INFO - No improvement for 2 epochs. Best val loss: 0.5345 at epoch 12
2025-04-16 07:39:10,449 - INFO - === Completed Epoch 14/30 ===

2025-04-16 07:39:10,449 - INFO - === Starting Epoch 15/30 ===
2025-04-16 07:39:10,449 - INFO - Starting training for epoch 15
2025-04-16 07:39:12,263 - INFO - Epoch 15 completed - Train Loss: 0.5995, Train Acc: 69.98%
2025-04-16 07:39:12,263 - INFO - Starting validation for epoch 15
2025-04-16 07:39:12,684 - INFO - Epoch 15 validation - Val Loss: 0.5681, Val Acc: 68.63%

2025-04-16 07:39:12,684 - INFO - Learning rate adjusted from 0.00075 to 0.000375
2025-04-16 07:39:12,685 - INFO - No improvement for 3 epochs. Best val loss: 0.5345 at epoch 12
2025-04-16 07:39:12,685 - INFO - === Completed Epoch 15/30 ===

2025-04-16 07:39:12,685 - INFO - === Starting Epoch 16/30 ===
2025-04-16 07:39:12,685 - INFO - Starting training for epoch 16
2025-04-16 07:39:14,486 - INFO - Epoch 16 completed - Train Loss: 0.5925, Train Acc: 72.15%
2025-04-16 07:39:14,486 - INFO - Starting validation for epoch 16
2025-04-16 07:39:14,909 - INFO - Epoch 16 validation - Val Loss: 0.5015, Val Acc: 70.59%

2025-04-16 07:39:14,910 - INFO - Saving model and training statistics to ../models/spec_cnn/all_lang_aware
2025-04-16 07:39:14,928 - INFO - Model checkpoint saved at epoch 16 with validation loss: 0.5015

2025-04-16 07:39:14,928 - INFO - New best model saved at epoch 16 with validation loss: 0.5015
2025-04-16 07:39:14,928 - INFO - === Completed Epoch 16/30 ===

2025-04-16 07:39:14,928 - INFO - === Starting Epoch 17/30 ===
2025-04-16 07:39:14,928 - INFO - Starting training for epoch 17
2025-04-16 07:39:16,743 - INFO - Epoch 17 completed - Train Loss: 0.5629, Train Acc: 74.09%
2025-04-16 07:39:16,743 - INFO - Starting validation for epoch 17
2025-04-16 07:39:17,177 - INFO - Epoch 17 validation - Val Loss: 0.4968, Val Acc: 74.51%

2025-04-16 07:39:17,178 - INFO - Saving model and training statistics to ../models/spec_cnn/all_lang_aware
2025-04-16 07:39:17,200 - INFO - Model checkpoint saved at epoch 17 with validation loss: 0.4968

2025-04-16 07:39:17,200 - INFO - New best model saved at epoch 17 with validation loss: 0.4968
2025-04-16 07:39:17,200 - INFO - === Completed Epoch 17/30 ===

2025-04-16 07:39:17,200 - INFO - === Starting Epoch 18/30 ===
2025-04-16 07:39:17,200 - INFO - Starting training for epoch 18
2025-04-16 07:39:18,997 - INFO - Epoch 18 completed - Train Loss: 0.5664, Train Acc: 72.15%
2025-04-16 07:39:18,997 - INFO - Starting validation for epoch 18
2025-04-16 07:39:19,449 - INFO - Epoch 18 validation - Val Loss: 0.5219, Val Acc: 74.51%

2025-04-16 07:39:19,449 - INFO - No improvement for 1 epochs. Best val loss: 0.4968 at epoch 17
2025-04-16 07:39:19,449 - INFO - === Completed Epoch 18/30 ===

2025-04-16 07:39:19,449 - INFO - === Starting Epoch 19/30 ===
2025-04-16 07:39:19,449 - INFO - Starting training for epoch 19
2025-04-16 07:39:21,295 - INFO - Epoch 19 completed - Train Loss: 0.5692, Train Acc: 70.70%
2025-04-16 07:39:21,295 - INFO - Starting validation for epoch 19
2025-04-16 07:39:21,745 - INFO - Epoch 19 validation - Val Loss: 0.5667, Val Acc: 64.71%

2025-04-16 07:39:21,746 - INFO - No improvement for 2 epochs. Best val loss: 0.4968 at epoch 17
2025-04-16 07:39:21,746 - INFO - === Completed Epoch 19/30 ===

2025-04-16 07:39:21,746 - INFO - === Starting Epoch 20/30 ===
2025-04-16 07:39:21,746 - INFO - Starting training for epoch 20
2025-04-16 07:39:23,592 - INFO - Epoch 20 completed - Train Loss: 0.5448, Train Acc: 75.30%
2025-04-16 07:39:23,592 - INFO - Starting validation for epoch 20
2025-04-16 07:39:24,073 - INFO - Epoch 20 validation - Val Loss: 0.5806, Val Acc: 72.55%

2025-04-16 07:39:24,073 - INFO - Learning rate adjusted from 0.000375 to 0.0001875
2025-04-16 07:39:24,073 - INFO - No improvement for 3 epochs. Best val loss: 0.4968 at epoch 17
2025-04-16 07:39:24,073 - INFO - === Completed Epoch 20/30 ===

2025-04-16 07:39:24,074 - INFO - === Starting Epoch 21/30 ===
2025-04-16 07:39:24,074 - INFO - Starting training for epoch 21
2025-04-16 07:39:25,921 - INFO - Epoch 21 completed - Train Loss: 0.5617, Train Acc: 74.33%
2025-04-16 07:39:25,922 - INFO - Starting validation for epoch 21
2025-04-16 07:39:26,379 - INFO - Epoch 21 validation - Val Loss: 0.5250, Val Acc: 72.55%

2025-04-16 07:39:26,380 - INFO - No improvement for 4 epochs. Best val loss: 0.4968 at epoch 17
2025-04-16 07:39:26,380 - INFO - === Completed Epoch 21/30 ===

2025-04-16 07:39:26,380 - INFO - === Starting Epoch 22/30 ===
2025-04-16 07:39:26,380 - INFO - Starting training for epoch 22
2025-04-16 07:39:28,206 - INFO - Epoch 22 completed - Train Loss: 0.5666, Train Acc: 72.88%
2025-04-16 07:39:28,207 - INFO - Starting validation for epoch 22
2025-04-16 07:39:28,675 - INFO - Epoch 22 validation - Val Loss: 0.6183, Val Acc: 72.55%

2025-04-16 07:39:28,675 - INFO - No improvement for 5 epochs. Best val loss: 0.4968 at epoch 17
2025-04-16 07:39:28,675 - INFO - === Completed Epoch 22/30 ===

2025-04-16 07:39:28,675 - INFO - === Starting Epoch 23/30 ===
2025-04-16 07:39:28,675 - INFO - Starting training for epoch 23
2025-04-16 07:39:30,521 - INFO - Epoch 23 completed - Train Loss: 0.5273, Train Acc: 77.72%
2025-04-16 07:39:30,522 - INFO - Starting validation for epoch 23
2025-04-16 07:39:30,981 - INFO - Epoch 23 validation - Val Loss: 0.5268, Val Acc: 68.63%

2025-04-16 07:39:30,981 - INFO - Learning rate adjusted from 0.0001875 to 9.375e-05
2025-04-16 07:39:30,981 - INFO - No improvement for 6 epochs. Best val loss: 0.4968 at epoch 17
2025-04-16 07:39:30,981 - INFO - === Completed Epoch 23/30 ===

2025-04-16 07:39:30,981 - INFO - === Starting Epoch 24/30 ===
2025-04-16 07:39:30,981 - INFO - Starting training for epoch 24
2025-04-16 07:39:32,819 - INFO - Epoch 24 completed - Train Loss: 0.5257, Train Acc: 75.79%
2025-04-16 07:39:32,819 - INFO - Starting validation for epoch 24
2025-04-16 07:39:33,287 - INFO - Epoch 24 validation - Val Loss: 0.5207, Val Acc: 74.51%

2025-04-16 07:39:33,287 - INFO - No improvement for 7 epochs. Best val loss: 0.4968 at epoch 17
2025-04-16 07:39:33,287 - INFO - === Completed Epoch 24/30 ===

2025-04-16 07:39:33,287 - INFO - === Starting Epoch 25/30 ===
2025-04-16 07:39:33,287 - INFO - Starting training for epoch 25
2025-04-16 07:39:35,108 - INFO - Epoch 25 completed - Train Loss: 0.5243, Train Acc: 75.30%
2025-04-16 07:39:35,109 - INFO - Starting validation for epoch 25
2025-04-16 07:39:35,555 - INFO - Epoch 25 validation - Val Loss: 0.5203, Val Acc: 72.55%

2025-04-16 07:39:35,556 - INFO - No improvement for 8 epochs. Best val loss: 0.4968 at epoch 17
2025-04-16 07:39:35,556 - INFO - === Completed Epoch 25/30 ===

2025-04-16 07:39:35,556 - INFO - === Starting Epoch 26/30 ===
2025-04-16 07:39:35,556 - INFO - Starting training for epoch 26
2025-04-16 07:39:37,371 - INFO - Epoch 26 completed - Train Loss: 0.5496, Train Acc: 75.30%
2025-04-16 07:39:37,371 - INFO - Starting validation for epoch 26
2025-04-16 07:39:37,834 - INFO - Epoch 26 validation - Val Loss: 0.5111, Val Acc: 66.67%

2025-04-16 07:39:37,834 - INFO - Learning rate adjusted from 9.375e-05 to 4.6875e-05
2025-04-16 07:39:37,834 - INFO - No improvement for 9 epochs. Best val loss: 0.4968 at epoch 17
2025-04-16 07:39:37,834 - INFO - === Completed Epoch 26/30 ===

2025-04-16 07:39:37,834 - INFO - === Starting Epoch 27/30 ===
2025-04-16 07:39:37,834 - INFO - Starting training for epoch 27
2025-04-16 07:39:39,676 - INFO - Epoch 27 completed - Train Loss: 0.5188, Train Acc: 76.51%
2025-04-16 07:39:39,676 - INFO - Starting validation for epoch 27
2025-04-16 07:39:40,154 - INFO - Epoch 27 validation - Val Loss: 0.5164, Val Acc: 72.55%

2025-04-16 07:39:40,154 - INFO - No improvement for 10 epochs. Best val loss: 0.4968 at epoch 17
2025-04-16 07:39:40,154 - INFO - Early stopping triggered after 27 epochs

2025-04-16 07:39:40,154 - INFO - Training completed. Best validation loss: 0.4968 at epoch 17

2025-04-16 07:39:40,154 - INFO - Training completed. Starting model evaluation
2025-04-16 07:39:40,154 - INFO - Starting model evaluation on test set
2025-04-16 07:39:40,593 - INFO - Test Evaluation Results:
2025-04-16 07:39:40,593 - INFO - Test Accuracy: 71.70%
2025-04-16 07:39:40,593 - INFO - Precision: 0.7647
2025-04-16 07:39:40,593 - INFO - Recall: 0.5417
2025-04-16 07:39:40,593 - INFO - F1 Score: 0.6341
2025-04-16 07:39:40,593 - INFO - Generating confusion matrix
2025-04-16 07:39:40,702 - INFO - Confusion matrix saved to ../models/spec_cnn/all_lang_aware/confusion_matrix.png
2025-04-16 07:39:40,702 - INFO - Generating training history plots
2025-04-16 07:39:40,928 - INFO - Training history plots saved to ../models/spec_cnn/all_lang_aware/training_history.png
2025-04-16 07:39:40,928 - INFO - ================================================================================
2025-04-16 07:39:40,928 - INFO - TRAINING SUMMARY:
2025-04-16 07:39:40,928 - INFO - Model: spec_cnn on all dataset
2025-04-16 07:39:40,928 - INFO - Best validation loss: 0.4968 achieved at epoch 17
2025-04-16 07:39:40,928 - INFO - Final training accuracy: 76.51%
2025-04-16 07:39:40,928 - INFO - Final validation accuracy: 72.55%
2025-04-16 07:39:40,928 - INFO - Model saved at: ../models/spec_cnn/all_lang_aware
2025-04-16 07:39:40,928 - INFO - Training completed successfully
2025-04-16 07:39:40,928 - INFO - ================================================================================
